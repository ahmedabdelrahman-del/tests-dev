1- curl -i -sS -X POST "$API_URL" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  --data "grant_type=client_credentials"

2- # Ensure variables are set
API_URL=$(terraform output -raw token_broker_invoke_url)
API_KEY=$(aws apigateway get-api-keys --include-values --region us-east-1 --query "items[?name=='cognito-throttle-lab-token-broker-api-key'].value" --output text)

# Test the API endpoint
curl -i -sS -X POST "$API_URL" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "x-api-key: $API_KEY" \
  --data "grant_type=client_credentials&scope=https://api.throttle-lab-u05gxq.local/tokens.read"

  3-  SCOPE="https://api.throttle-lab-u05gxq.local/tokens.read"

for i in $(seq 1 40); do
  curl -s -o /dev/null -w "%{http_code}\n" \
    -X POST "$API_URL" \
    -H "x-api-key: $API_KEY" \
    -H "Content-Type: application/x-www-form-urlencoded" \
    --data-urlencode "grant_type=client_credentials" \
    --data-urlencode "scope=$SCOPE" &
done
wait
